<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Dashboard | FingerPay AI</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Outfit:wght@500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom CSS -->
    <link href="agentDB.css" rel="stylesheet">
</head>
<body class="bg-light">

    <div class="d-flex" id="wrapper">
        
        <!-- SIDEBAR -->
        <div class="agent-sidebar bg-dark text-white p-3 d-flex flex-column vh-100 position-fixed" id="sidebar">
            <div class="mb-5 px-2 d-flex align-items-center gap-2 logo-area">
                <i class="bi bi-fingerprint text-gold fs-3"></i>
                <div>
                    <h5 class="fw-bold mb-0 font-heading">FingerPay</h5>
                    <small class="text-gold letter-spacing-2" style="font-size: 0.65rem;">AGENT PORTAL</small>
                </div>
            </div>

            <ul class="nav flex-column gap-2" id="sidebarNav">
                <li class="nav-item">
                    <a href="#" class="nav-link active" onclick="showSection('dashboard', this)">
                        <i class="bi bi-grid-fill me-2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('registration', this)">
                        <i class="bi bi-person-plus-fill me-2"></i> Registration
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('merchant', this)">
                        <i class="bi bi-shop-window me-2"></i> Merchants
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('earnings', this)">
                        <i class="bi bi-wallet2 me-2"></i> Earnings
                    </a>
                </li>
                <!-- NEW GROUP 1 -->
                <li class="nav-item mt-2">
                    <small class="text-muted ms-3 text-uppercase" style="font-size: 0.7rem;">Intelligence</small>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('finagent', this)">
                        <i class="bi bi-stars text-gold me-2"></i> FinAgent AI
                    </a>
                </li>
                
                
                <li class="nav-item mt-2">
                    <a href="#" class="nav-link" onclick="showSection('reports', this)">
                        <i class="bi bi-file-earmark-bar-graph-fill me-2"></i> Reports
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('settings', this)">
                        <i class="bi bi-gear-fill me-2"></i> Settings
                    </a>
                </li>
            </ul>

            <div class="mt-auto p-3 bg-white bg-opacity-10 rounded-3">
                <small class="text-white-50 d-block mb-1">AI Status</small>
                <div class="fw-bold text-success"><i class="bi bi-broadcast me-2"></i> Online</div>
            </div>
            
            <button class="btn btn-outline-danger mt-3 border-0 text-start w-100" data-bs-toggle="modal" data-bs-target="#logoutModal">
                <i class="bi bi-box-arrow-left me-2"></i> Logout
            </button>
        </div>

        <!-- MAIN CONTENT WRAPPER -->
        <div class="agent-content w-100">
            
            <!-- TOP HEADER -->
            <nav class="navbar navbar-expand-lg bg-white shadow-sm px-4 py-3 sticky-top">
                <div class="d-flex align-items-center w-100">
                    <button class="btn btn-light d-lg-none me-3" id="sidebarToggle"><i class="bi bi-list fs-4"></i></button>
                    <div>
                        <h4 class="fw-bold mb-0" id="pageTitle">Overview</h4>
                        <small class="text-muted" id="currentDate">Loading date...</small>
                    </div>
                    
                    <div class="ms-auto d-flex align-items-center gap-4">
                        <!-- AI Cash-Out Predictor Alert -->
                        <div class="alert alert-warning border-warning d-none d-md-flex align-items-center py-1 px-3 mb-0 rounded-pill shadow-sm cursor-pointer animate-pulse" onclick="showCashOutPrediction()">
                            <i class="bi bi-lightbulb-fill me-2"></i>
                            <small class="fw-bold">AI Insight: High Demand</small>
                        </div>

                        <div class="position-relative cursor-pointer hover-scale" title="Notifications">
                            <i class="bi bi-bell fs-5"></i>
                            <span class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle"></span>
                        </div>
                        
                        <!-- Profile -->
                        <div class="d-flex align-items-center gap-3 border-start ps-4 cursor-pointer" onclick="showSection('settings', null)" title="Go to Settings">
                            <div class="text-end d-none d-md-block">
                                <h6 class="fw-bold mb-0">Ahmed Musa</h6>
                                <small class="text-muted">ID: AG-8821092</small>
                            </div>
                            <div class="position-relative">
                                <img src="https://i.pravatar.cc/150?img=11" class="rounded-circle border border-2 border-warning" width="45">
                                <span class="position-absolute bottom-0 end-0 bg-success border border-white rounded-circle p-1"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-4">

                <!-- ================= SECTION 1: DASHBOARD ================= -->
                <section id="dashboard-section" class="content-section fade-in">
                    <!-- Agent Level Card -->
                    <div class="card bg-dark text-white border-0 shadow-sm rounded-4 mb-4 overflow-hidden position-relative">
                        <div class="position-absolute top-0 end-0 w-50 h-100" style="background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.15));"></div>
                        <div class="card-body p-4 position-relative z-1">
                            <div class="row align-items-center">
                                <div class="col-lg-8">
                                    <div class="d-flex align-items-center mb-2">
                                        <span class="badge bg-warning text-dark fw-bold me-2">CURRENT LEVEL</span>
                                        <h5 class="mb-0 text-gold font-heading">AG-LV2 (PRO)</h5>
                                    </div>
                                    <h2 class="fw-bold mb-3">Keep pushing, Ahmed! üöÄ</h2>
                                    <p class="text-white-50 mb-3">You are <strong class="text-white">12 registrations</strong> away from becoming <span class="text-white fw-bold">AG-LV3 (Elite)</span>.</p>
                                    <div class="progress bg-white bg-opacity-10" style="height: 10px;">
                                        <div class="progress-bar bg-gold" role="progressbar" style="width: 75%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between mt-2 small text-white-50">
                                        <span>Current: 38 Reg</span>
                                        <span>Target: 50 Reg</span>
                                    </div>
                                </div>
                                <div class="col-lg-4 text-center border-start border-white border-opacity-10 mt-3 mt-lg-0">
                                    <div class="py-2">
                                        <small class="text-uppercase text-white-50 letter-spacing-2">Wallet Balance</small>
                                        <h1 class="fw-bold text-success mb-0">N145,500</h1>
                                        <button class="btn btn-sm btn-outline-light rounded-pill mt-3 px-4" data-bs-toggle="modal" data-bs-target="#payoutModal">
                                            Request Payout
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics Grid -->
                    <div class="row g-4 mb-4">
                        <div class="col-md-3"><div class="card border-0 shadow-sm h-100 p-3 hover-scale"><div class="d-flex justify-content-between"><div><h3 class="fw-bold mb-0">38</h3><p class="text-muted small">Total Reg.</p></div><div class="icon-square bg-primary bg-opacity-10 text-primary rounded-3"><i class="bi bi-people-fill fs-4"></i></div></div></div></div>
                        <div class="col-md-3"><div class="card border-0 shadow-sm h-100 p-3 hover-scale"><div class="d-flex justify-content-between"><div><h3 class="fw-bold mb-0">12</h3><p class="text-muted small">Merchants</p></div><div class="icon-square bg-success bg-opacity-10 text-success rounded-3"><i class="bi bi-shop fs-4"></i></div></div></div></div>
                        <div class="col-md-3"><div class="card border-0 shadow-sm h-100 p-3 hover-scale"><div class="d-flex justify-content-between"><div><h3 class="fw-bold mb-0">20</h3><p class="text-muted small">POS Fleet</p></div><div class="icon-square bg-warning bg-opacity-10 text-warning rounded-3"><i class="bi bi-hdd-network fs-4"></i></div></div></div></div>
                        <div class="col-md-3"><div class="card border-0 shadow-sm h-100 p-3 hover-scale"><div class="d-flex justify-content-between"><div><h3 class="fw-bold mb-0">N500</h3><p class="text-muted small">Comm. Rate</p></div><div class="icon-square bg-info bg-opacity-10 text-info rounded-3"><i class="bi bi-graph-up-arrow fs-4"></i></div></div></div></div>
                    </div>

                    <!-- Performance Chart -->
                    <div class="card border-0 shadow-sm h-100 mb-4">
                        <div class="card-header bg-white border-0 py-3"><h6 class="fw-bold mb-0">Performance Overview</h6></div>
                        <div class="card-body"><canvas id="dashboardChart" style="height: 300px; width: 100%;"></canvas></div>
                    </div>
                </section>

               <!-- ================= SECTION: FINAGENT AI (Unified Command Center) ================= -->
<section id="finagent-section" class="content-section fade-in">
    <!-- Header & Daily Summary -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="d-flex align-items-center gap-3">
            <div class="icon-square bg-gold text-dark rounded-3 shadow-sm p-3">
                <i class="bi bi-robot fs-4"></i>
            </div>
            <div>
                <h5 class="fw-bold mb-0">FinAgent AI</h5>
                <small class="text-muted">Ops, Cash Prediction & Polyglot Education.</small>
            </div>
        </div>
        <!-- Functionality: Calls summarizeDay() -->
        <button class="btn btn-dark rounded-pill px-4 shadow-sm hover-scale position-relative" onclick="summarizeDay()">
            <i class="bi bi-list-check me-2 text-gold"></i> Summarize Day
            <!-- SDG 3: Stress Notification Dot -->
            <span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle pulse-red" id="stressDot">
                <span class="visually-hidden">Stress Alert</span>
            </span>
        </button>
    </div>

    <!-- ROW 1: POLYGLOT COMMAND CENTER (Loan + Edu Scripts) -->
    <div class="card border-0 shadow-sm mb-4 overflow-hidden">
        <div class="card-header bg-white border-bottom py-3 d-flex justify-content-between align-items-center">
            <h6 class="fw-bold mb-0 text-primary"><i class="bi bi-translate me-2"></i>Polyglot Communicator & Loan Officer</h6>
            <!-- Tabs to switch modes -->
            <ul class="nav nav-pills card-header-pills" id="polyglotTabs">
                <li class="nav-item">
                    <a class="nav-link active btn-sm" href="#" onclick="switchPolyMode('loan', this)">Loan Contract</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link btn-sm" href="#" onclick="switchPolyMode('edu', this)">Edu Script (SDG 4)</a>
                </li>
            </ul>
        </div>
        <div class="card-body p-4">
            <div class="row g-4">
                <!-- Input Area -->
                <div class="col-lg-4 border-end">
                    
                    <!-- Mode: Loan Inputs -->
                    <div id="loanInputs">
                        <label class="small fw-bold text-muted mb-2">Merchant Details</label>
                        <div class="input-group mb-3">
                            <span class="input-group-text"><i class="bi bi-shop"></i></span>
                            <input type="text" class="form-control" id="loanMerchId" placeholder="Merchant ID">
                        </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text"><i class="bi bi-graph-up"></i></span>
                            <input type="number" class="form-control" id="loanScore" placeholder="Credit Score (e.g. 785)">
                        </div>
                    </div>

                    <!-- Mode: Education Inputs (Hidden by default) -->
                    <div id="eduInputs" class="d-none">
                        <label class="small fw-bold text-muted mb-2">Select Training Topic</label>
                        <select class="form-select mb-3" id="eduTopic">
                            <option value="interest">Explaining Interest Rates</option>
                            <option value="fraud">Avoiding POS Fraud</option>
                            <option value="app">How to use the App</option>
                        </select>
                    </div>
                    
                    <label class="small fw-bold text-muted mb-2">Target Language</label>
                    <select class="form-select mb-4" id="targetLanguage">
                        <option value="English" selected>üá¨üáß English</option>
                        <option value="Pidgin">üá≥üá¨ Pidgin English</option>
                        <option value="Hausa">üêé Hausa</option>
                        <option value="Yoruba">ü¶Å Yoruba</option>
                        <option value="Igbo">ü¶Ö Igbo</option>
                    </select>

                    <button class="btn btn-primary w-100 fw-bold py-2 shadow-sm" onclick="runPolyglotGen()">
                        <i class="bi bi-lightning-charge me-2"></i> Generate Output
                    </button>
                </div>

                <!-- Output Area -->
                <div class="col-lg-8">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="badge bg-light text-dark border" id="polyStatus">Ready to Generate...</span>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-dark" onclick="copyPolyText()" title="Copy Text"><i class="bi bi-clipboard"></i> Copy</button>
                            <button class="btn btn-sm btn-outline-primary" onclick="sendToMerchant()" title="Send to Merchant App"><i class="bi bi-send"></i> Send</button>
                        </div>
                    </div>
                    <div class="bg-dark text-white p-3 rounded-3 font-monospace small position-relative" style="min-height: 250px; max-height: 300px; overflow-y: auto;">
                        <div id="polyOutput" class="text-white-50 typing-cursor">
                            // AI Agent Awaiting Command...<br>
                            // Select a mode (Loan or Education).<br>
                            // Choose a language (Hausa, Igbo, Yoruba, etc).
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4 mb-4">
        <!-- ROW 2, COL 1: SMART ROUTE + CASH PREDICTION -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0 py-3 d-flex justify-content-between align-items-center">
                    <h6 class="fw-bold mb-0"><i class="bi bi-map-fill text-danger me-2"></i>Route & Cash Prediction</h6>
                    <span class="badge bg-success bg-opacity-10 text-success">Live Traffic</span>
                </div>
                <div class="card-body">
                    <div class="input-group mb-3">
                        <span class="input-group-text bg-white"><i class="bi bi-geo-alt-fill text-danger"></i></span>
                        <input type="text" class="form-control" id="startLocation" placeholder="Current Location...">
                        <button class="btn btn-danger" onclick="optimizeRoute()">Optimize</button>
                    </div>
                    
                    <div class="list-group list-group-flush" id="routeList">
                        <div class="text-center py-4 text-muted small">
                            AI will predict optimal path and cash demand per stop.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ROW 2, COL 2: INCIDENT AI -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0 py-3">
                    <h6 class="fw-bold mb-0"><i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>Incident Reporter</h6>
                </div>
                <div class="card-body">
                    <div id="incidentForm">
                        <div class="row g-2 mb-3">
                            <div class="col-md-4">
                                <input type="text" class="form-control form-control-sm" id="incidentMerchId" placeholder="Merch ID">
                            </div>
                            <div class="col-md-8">
                                <select class="form-select form-select-sm" id="incidentType">
                                    <option value="POS Hardware">POS Hardware Fault</option>
                                    <option value="Network">Network Failure</option>
                                    <option value="Fraud">Suspected Fraud</option>
                                </select>
                            </div>
                        </div>
                        <textarea class="form-control bg-light border-0 mb-3" rows="3" id="incidentInput" placeholder="Describe issue..."></textarea>
                        <button class="btn btn-warning w-100 fw-bold mb-3" onclick="generateIncidentReport()">Generate Ticket</button>
                    </div>
                    
                    <div id="ticketResult" class="d-none bg-dark text-white p-3 rounded-3 small font-monospace position-relative">
                        <button class="btn btn-sm btn-light position-absolute top-0 end-0 m-2 py-0 px-2" onclick="copyTicket()" style="font-size: 0.7rem;">Copy</button>
                        <div id="ticketText" class="mb-3 pt-2"></div>
                        <div class="d-flex gap-2 border-top border-secondary pt-2 mt-2">
                            <button class="btn btn-sm btn-secondary w-50" onclick="editTicket()">Edit</button>
                            <button class="btn btn-sm btn-success w-50" onclick="addTicketNote()">Add AI Note</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ROW 3: MICRO-TRAINING HUB (SDG 4) -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm bg-dark text-white overflow-hidden">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6 class="fw-bold mb-0 text-info"><i class="bi bi-mortarboard-fill me-2"></i>Micro-Training Modules (Agent Growth)</h6>
                        <span class="badge bg-info text-dark">SDG 4</span>
                    </div>
                    <div class="row g-3">
                        <!-- Module 1 -->
                        <div class="col-md-4">
                            <div class="p-3 rounded bg-white bg-opacity-10 training-card" onclick="startMicroModule('fraud')">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-shield-lock fs-3 text-warning me-3"></i>
                                    <div>
                                        <h6 class="fw-bold mb-0">Fraud Detection 101</h6>
                                        <small class="text-white-50">3 Mins ‚Ä¢ Quick Audit</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Module 2 -->
                        <div class="col-md-4">
                            <div class="p-3 rounded bg-white bg-opacity-10 training-card" onclick="startMicroModule('sales')">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-graph-up-arrow fs-3 text-success me-3"></i>
                                    <div>
                                        <h6 class="fw-bold mb-0">Upselling Loans</h6>
                                        <small class="text-white-50">5 Mins ‚Ä¢ Pitching</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Module 3 -->
                        <div class="col-md-4">
                            <div class="p-3 rounded bg-white bg-opacity-10 training-card" onclick="startMicroModule('stress')">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-heart-pulse fs-3 text-danger me-3"></i>
                                    <div>
                                        <h6 class="fw-bold mb-0">Stress Management</h6>
                                        <small class="text-white-50">2 Mins ‚Ä¢ Wellness</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

                <!-- ================= SECTION 4: REGISTRATION ================= -->
                <section id="registration-section" class="content-section d-none">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="fw-bold">Registration Center</h5>
                        <button class="btn btn-primary rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#registerModal">
                            <i class="bi bi-person-plus-fill me-2"></i> Register New User
                        </button>
                    </div>
                    <!-- Monthly Target -->
                    <div class="card border-0 shadow-sm mb-4 p-4 bg-white">
                        <div class="d-flex justify-content-between align-items-end mb-2">
                            <div><h6 class="fw-bold text-uppercase text-muted mb-1">Monthly Target</h6><h4 class="fw-bold mb-0">65 / 100</h4></div>
                            <span class="badge bg-primary">65% Achieved</span>
                        </div>
                        <div class="progress" style="height: 12px;"><div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 65%"></div></div>
                    </div>
                </section>

                <!-- ================= SECTION 5: MERCHANTS ================= -->
                <section id="merchant-section" class="content-section d-none">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="fw-bold">Merchant Network</h5>
                        <button class="btn btn-success rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#merchantModal"><i class="bi bi-shop me-2"></i> Onboard Merchant</button>
                    </div>
                    <div class="card border-0 shadow-sm">
                        <div class="table-responsive">
                            <table class="table align-middle mb-0 table-hover">
                                <thead class="bg-light"><tr><th class="ps-4">Business Name</th><th>ID</th><th>Status</th><th class="text-end pe-4">Action</th></tr></thead>
                                <tbody>
                                    <tr><td class="ps-4 fw-bold">Mama Nkechi Provisions</td><td class="font-monospace">MER-2210</td><td><span class="badge bg-success-subtle text-success">Active</span></td><td class="text-end pe-4"><button class="btn btn-sm btn-light border"><i class="bi bi-gear-fill"></i></button></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- ================= SECTION 6: EARNINGS ================= -->
                <section id="earnings-section" class="content-section d-none">
                    <div class="row g-4 mb-4">
                        <div class="col-md-6"><div class="card border-0 shadow-sm p-4 bg-dark text-white h-100"><small class="text-white-50 text-uppercase">Total Earned</small><h1 class="fw-bold text-gold mb-0">N1,250,500</h1></div></div>
                        <div class="col-md-6"><div class="card border-0 shadow-sm p-4 h-100"><div class="d-flex justify-content-between"><small class="text-muted text-uppercase">Available Balance</small><span class="badge bg-success">Ready</span></div><h1 class="fw-bold text-dark mb-3">N145,500</h1><button class="btn btn-success w-100 fw-bold" data-bs-toggle="modal" data-bs-target="#payoutModal">Cash Out</button></div></div>
                    </div>
                </section>

                <!-- ================= SECTION 7: REPORTS ================= -->
                <section id="reports-section" class="content-section d-none">
                    <div class="card border-0 shadow-sm"><div class="card-header bg-white border-0 py-3"><h6 class="fw-bold mb-0">Issue Tracker</h6></div>
                    <div class="table-responsive"><table class="table align-middle mb-0"><thead class="bg-light"><tr><th class="ps-4">Ticket</th><th>Subject</th><th>Status</th></tr></thead><tbody><tr><td class="ps-4">TKT-001</td><td>POS Fault</td><td><span class="badge bg-secondary">Received</span></td></tr></tbody></table></div></div>
                </section>

                <!-- ================= SECTION 8: SETTINGS ================= -->
                <section id="settings-section" class="content-section d-none fade-in">
                    <div class="d-flex align-items-center mb-4"><button class="btn btn-light rounded-circle me-3 shadow-sm" onclick="showSection('dashboard', document.querySelector('.nav-link.active'))"><i class="bi bi-arrow-left"></i></button><div><h4 class="fw-bold mb-0">Account Settings</h4></div></div>
                    <div class="row g-4"><div class="col-lg-3"><div class="card border-0 shadow-sm rounded-4 overflow-hidden"><div class="list-group list-group-flush" id="settingsTabs"><button class="list-group-item list-group-item-action p-3 active border-0" onclick="openSettingTab('profile', this)">Profile</button><button class="list-group-item list-group-item-action p-3 border-0" onclick="openSettingTab('security', this)">Security</button></div></div></div><div class="col-lg-9"><div id="tab-profile" class="setting-pane fade-in"><div class="card border-0 shadow-sm rounded-4 p-4"><h5>Profile</h5><input type="text" class="form-control mb-3" value="Ahmed Musa" disabled><button class="btn btn-dark">Save</button></div></div><div id="tab-security" class="setting-pane d-none fade-in"><div class="card border-0 shadow-sm rounded-4 p-4"><h5>Security</h5><button class="btn btn-outline-danger w-100" onclick="confirmKillSwitch()">Kill Switch</button></div></div></div></div>
                </section>

            </div>
        </div>
    </div>

    <!-- ================= MODALS ================= -->
    <!-- Cash Out Prediction Modal -->
    <div class="modal fade" id="cashOutModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0 shadow-lg"><div class="modal-header bg-warning border-0"><h5 class="fw-bold text-dark">AI Prediction</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body p-4 text-center"><i class="bi bi-graph-up-arrow display-4 text-warning mb-3"></i><h4>High Demand Expected</h4><p class="text-muted">Based on Friday trends, you need <strong>N200,000</strong> float today.</p><button class="btn btn-dark w-100 rounded-pill mt-3">Request Float</button></div></div></div></div>

    <!-- Payout Modal -->
    <div class="modal fade" id="payoutModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0"><div class="modal-header border-0 pb-0"><h5 class="fw-bold">Cash Out</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><input type="number" class="form-control mb-3" placeholder="Amount"><button class="btn btn-success w-100 fw-bold" onclick="simulateAction('Payout Sent!', '#payoutModal')">Confirm</button></div></div></div></div>

    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0"><div class="modal-header bg-primary text-white"><h5 class="fw-bold">Enroll Customer</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4"><button class="btn btn-primary w-100 fw-bold" onclick="simulateAction('Customer Registered!', '#registerModal')">Complete</button></div></div></div></div>

    <!-- Merchant Modal -->
    <div class="modal fade" id="merchantModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0"><div class="modal-header bg-success text-white"><h5 class="fw-bold">New Merchant</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4"><button class="btn btn-success w-100 fw-bold" onclick="simulateAction('Merchant Onboarded!', '#merchantModal')">Register</button></div></div></div></div>

    <!-- Logout Modal -->
    <div class="modal fade" id="logoutModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 text-center p-4"><h5 class="fw-bold">Log Out?</h5><div class="d-flex justify-content-center gap-2 mt-3"><button class="btn btn-light" data-bs-dismiss="modal">Cancel</button><button class="btn btn-danger" onclick="location.href='agent-login.html'">Yes</button></div></div></div></div>

    <!-- Kill Switch Modal -->
    <div class="modal fade" id="killSwitchModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0 text-center p-4"><h4 class="fw-bold text-danger">Emergency Freeze</h4><button class="btn btn-danger btn-lg fw-bold w-100 mt-3" onclick="finalizeKillSwitch()">CONFIRM</button></div></div></div>
<!-- 1. Daily Summary Modal (With SDG 3 Stress Alert) -->
<div class="modal fade" id="summaryModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-dark text-white">
                <h5 class="fw-bold"><i class="bi bi-robot text-gold me-2"></i>Daily Briefing & Wellness</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <h6 class="fw-bold text-success mb-3">Good Morning, Agent!</h6>
                
                <!-- SDG 3: Workload Stress Alert -->
                <div class="alert alert-danger border-0 bg-danger bg-opacity-10 d-flex align-items-start mb-3">
                    <i class="bi bi-heart-pulse-fill text-danger fs-4 me-3 mt-1"></i>
                    <div>
                        <h6 class="fw-bold text-danger mb-1">Workload Alert: High Traffic</h6>
                        <p class="mb-0 small text-muted">AI predicts heavy traffic on your route today. Stress risk is elevated. <strong>Schedule a 15-min break at 1:00 PM.</strong></p>
                    </div>
                </div>

                <div class="alert alert-light border border-dashed mb-3">
                    <p class="mb-1"><strong>üéØ Goal:</strong> 5 Merchant Registrations</p>
                    <p class="mb-1"><strong>üìç Route:</strong> 3 Merchants (Cash-Out Predicted).</p>
                    <p class="mb-0"><strong>üíµ Float Advice:</strong> N200,000 required.</p>
                </div>
                
                <button class="btn btn-primary w-100 rounded-pill" onclick="requestFloatFromSummary()">
                    Acknowledge & Request Float
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 2. Request Float Modal (Unchanged logic, just ensure ID matches) -->
<div class="modal fade" id="requestFloatModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header bg-warning border-0">
                <h5 class="fw-bold text-dark"><i class="bi bi-cash-stack me-2"></i>Request Cash Float</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handleFloatRequest(event)">
                    <div class="mb-3">
                        <label class="small fw-bold">Amount Needed (N)</label>
                        <input type="number" class="form-control form-control-lg fw-bold" id="floatAmount" placeholder="200000" required>
                    </div>
                    <div class="mb-3">
                        <label class="small fw-bold">Reason (AI Verified)</label>
                        <select class="form-select">
                            <option>High Volume Weekend</option>
                            <option>Merchant Bulk Withdrawal</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-dark w-100 fw-bold">Submit Request</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 3. Micro-Training Popup (SDG 4) -->
<div class="modal fade" id="microTrainModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content bg-dark text-white border-info border">
            <div class="modal-header border-bottom border-secondary">
                <h6 class="fw-bold text-info mb-0" id="trainTitle">Training</h6>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-3 text-center">
                <i class="bi bi-play-circle-fill display-4 text-white mb-3" onclick="alert('Playing Video...')"></i>
                <p class="small text-white-50" id="trainDesc">Loading module content...</p>
                <button class="btn btn-sm btn-outline-info w-100 rounded-pill">Mark Complete</button>
            </div>
        </div>
    </div>
</div>
    <!-- Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"><div id="liveToast" class="toast align-items-center text-white bg-success border-0"><div class="d-flex"><div class="toast-body" id="toastMessage">Success</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div></div></div>


    <div class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
        <div id="liveToast" class="toast align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body" id="toastMessage">
                    Action Successful.
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
    </div>
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- API Configuration and Client -->
    <script src="config.js"></script>
    <script src="api.js"></script>
    
    <!-- Dashboard Script -->
    <script src="agentDB.js"></script>
</body>
</html>