<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Dashboard | FingerPay</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Outfit:wght@500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom CSS -->
    <link href="merchantDB.css" rel="stylesheet">
</head>
<body class="bg-light-blue">

    <div class="d-flex" id="wrapper">
        
        <!-- SIDEBAR -->
        <div class="sidebar bg-dark-blue text-white p-3 d-flex flex-column vh-100 position-fixed" id="sidebar">
            <div class="mb-5 px-2 d-flex align-items-center gap-2">
                <i class="bi bi-fingerprint text-info fs-3"></i>
                <div>
                    <h5 class="fw-bold mb-0 font-heading">FingerPay</h5>
                    <small class="text-info letter-spacing-2" style="font-size: 0.65rem;">BUSINESS</small>
                </div>
            </div>

            <ul class="nav flex-column gap-2" id="sidebarNav">
                <li class="nav-item"><a href="#" class="nav-link active" onclick="showSection('dashboard', this); return false;"><i class="bi bi-grid-fill me-2"></i> Overview</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="showSection('sales', this); return false;"><i class="bi bi-receipt me-2"></i> Sales & History</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="showSection('projects', this); return false;"><i class="bi bi-bricks me-2"></i> Higher Projects</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="showSection('logistics', this); return false;"><i class="bi bi-box-seam me-2"></i> POS Logistics</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="showSection('staff', this); return false;"><i class="bi bi-people-fill me-2"></i> Staff & Payroll</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="showSection('settings', this); return false;"><i class="bi bi-gear-fill me-2"></i> Settings</a></li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('credit', this); return false;">
                        <i class="bi bi-leaf"></i> Credit AI
                    </a>
                </li>
            </ul>

            <div class="mt-auto">
                <div class="p-3 bg-white bg-opacity-10 rounded-3 mb-3">
                    <small class="text-white-50 d-block mb-1">Your Aggregator</small>
                    <div class="d-flex align-items-center gap-2">
                        <img src="https://i.pravatar.cc/150?img=11" class="rounded-circle border border-info" width="30">
                        <div>
                            <span class="d-block fw-bold small">Ahmed Musa</span>
                            <small class="text-info" style="font-size: 0.7rem;">Branch: Yaba HQ</small>
                        </div>
                    </div>
                </div>
                <button class="btn btn-outline-danger w-100 border-0 text-start" data-bs-toggle="modal" data-bs-target="#logoutModal">
                    <i class="bi bi-box-arrow-left me-2"></i> Logout
                </button>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="content w-100">
            
            <!-- TOP HEADER -->
            <nav class="navbar navbar-expand-lg bg-white shadow-sm px-4 py-3 sticky-top">
                <div class="d-flex align-items-center w-100">
                    <button class="btn btn-light d-lg-none me-3" id="menuToggle"><i class="bi bi-list"></i></button>
                    <div>
                        <h4 class="fw-bold mb-0" id="pageTitle">Dashboard</h4>
                        <small class="text-muted" id="currentDate">Loading...</small>
                    </div>
                    
                    <div class="ms-auto d-flex align-items-center gap-4">
                        <!-- Profile is Clickable to go to Settings -->
                        <div class="d-none d-md-block text-end cursor-pointer" onclick="event.preventDefault(); showSection('settings', null, event)" title="Go to Settings">
                            <span class="badge bg-primary bg-opacity-10 text-primary border border-primary">MER-LV2</span>
                            <small class="d-block text-muted small">Mama Nkechi Store</small>
                        </div>
                        <div class="position-relative cursor-pointer" onclick="event.preventDefault(); showSection('settings', null, event)">
                            <img src="https://i.pravatar.cc/150?img=5" class="rounded-circle border border-2 border-primary" width="45">
                            <span class="position-absolute bottom-0 end-0 bg-success border border-white rounded-circle p-1"></span>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-4">

                <!-- ================= SECTION 1: DASHBOARD ================= -->
                <section id="dashboard-section" class="content-section fade-in">
                    <!-- Merchant Level Banner -->
                    <div class="card border-0 shadow-sm rounded-4 mb-4 bg-dark-blue text-white overflow-hidden position-relative">
                        <div class="blob-bg"></div>
                        <div class="card-body p-4 position-relative z-1">
                            <div class="row align-items-center">
                                <div class="col-lg-8">
                                    <div class="d-flex align-items-center mb-2">
                                        <i class="bi bi-trophy-fill text-warning me-2 fs-4"></i>
                                        <h5 class="fw-bold mb-0 text-info">MER-LV2 (Growing Business)</h5>
                                    </div>
                                    <p class="text-white-50 mb-3">You have unlocked: <strong class="text-white">3 Free Transfers/Day</strong> & <strong class="text-white">N200k Loan Limit</strong>.</p>
                                    <div class="progress bg-white bg-opacity-10" style="height: 8px;">
                                        <div class="progress-bar bg-info" role="progressbar" style="width: 60%"></div>
                                    </div>
                                    <small class="text-white-50 mt-1 d-block">Next Level: MER-LV3 (Unlock Merch Pack: T-Shirt & Cap)</small>
                                </div>
                                <div class="col-lg-4 text-center border-start border-white border-opacity-10 mt-3 mt-lg-0">
                                    <small class="text-uppercase text-white-50">Wallet Balance</small>
                                    <h2 class="fw-bold mb-0">N450,200.00</h2>
                                    <button class="btn btn-sm btn-info text-dark fw-bold rounded-pill mt-2" data-bs-toggle="modal" data-bs-target="#withdrawModal">Withdraw Funds</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="row g-4 mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100 p-3 hover-up">
                                <div class="d-flex justify-content-between">
                                    <div><h3 class="fw-bold mb-0">N85k</h3><small class="text-muted">Today's Sales</small></div>
                                    <div class="icon-sq bg-success bg-opacity-10 text-success"><i class="bi bi-graph-up-arrow"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100 p-3 hover-up">
                                <div class="d-flex justify-content-between">
                                    <div><h3 class="fw-bold mb-0">42</h3><small class="text-muted">Transactions</small></div>
                                    <div class="icon-sq bg-primary bg-opacity-10 text-primary"><i class="bi bi-receipt"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100 p-3 hover-up">
                                <div class="d-flex justify-content-between">
                                    <div><h3 class="fw-bold mb-0">3</h3><small class="text-muted">Active POS</small></div>
                                    <div class="icon-sq bg-warning bg-opacity-10 text-warning"><i class="bi bi-hdd-network"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm h-100 p-3 hover-up">
                                <div class="d-flex justify-content-between">
                                    <div><h3 class="fw-bold mb-0">Ahmed</h3><small class="text-muted">Your Agent</small></div>
                                    <div class="icon-sq bg-info bg-opacity-10 text-info cursor-pointer" data-bs-toggle="modal" data-bs-target="#agentContactModal"><i class="bi bi-telephone-fill"></i></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    
                </section>

                <!-- ================= SECTION 2: HIGHER PROJECTS ================= -->
                <section id="projects-section" class="content-section d-none fade-in">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div><h5 class="fw-bold mb-0">Higher Projects</h5><small class="text-muted">Manage your business goals.</small></div>
                        <button class="btn btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#newProjectModal"><i class="bi bi-plus-lg me-2"></i>New Project</button>
                    </div>

                    <!-- Project Card -->
                    <div class="card border-0 shadow-sm rounded-4 mb-4">
                        <div class="card-header bg-white border-0 py-3 d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center gap-3">
                                <div class="icon-sq bg-purple bg-opacity-10 text-purple rounded-3"><i class="bi bi-paint-bucket fs-4"></i></div>
                                <div><h5 class="fw-bold mb-0">Shop Renovation</h5><small class="text-muted">Target: Dec 20, 2025</small></div>
                            </div>
                            <div class="text-end"><h4 class="fw-bold text-success mb-0" id="projectSavedAmount">N200,000</h4><span class="badge bg-warning text-dark">In Progress</span></div>
                        </div>
                        <div class="card-body">
                            <div class="progress mb-4" style="height: 15px;"><div class="progress-bar bg-success progress-bar-striped progress-bar-animated" id="projectProgressBar" role="progressbar" style="width: 40%">40% Funded</div></div>
                            <h6 class="fw-bold text-muted small text-uppercase mb-3">Tasks</h6>
                            <div class="list-group list-group-flush mb-3" id="taskListArea">
                                <div class="list-group-item d-flex justify-content-between px-0 py-2 border-dashed">
                                    <div><input type="checkbox" checked disabled> Painting</div><span class="fw-bold text-muted">N100,000</span>
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-success flex-grow-1" data-bs-toggle="modal" data-bs-target="#addFundsModal"><i class="bi bi-cash-coin me-2"></i>Add Funds</button>
                                <button class="btn btn-outline-dark flex-grow-1" data-bs-toggle="modal" data-bs-target="#addTaskModal"><i class="bi bi-list-task me-2"></i>Add Task</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ================= SECTION 3: POS LOGISTICS ================= -->
                <section id="logistics-section" class="content-section d-none fade-in">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div><h5 class="fw-bold mb-0">POS Fleet</h5><small class="text-muted">Manage terminals & supplies.</small></div>
                        <button class="btn btn-outline-dark btn-sm rounded-pill" data-bs-toggle="modal" data-bs-target="#consumablesModal"><i class="bi bi-receipt-cutoff me-2"></i> Supplies</button>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm h-100 p-4 text-center hover-up position-relative overflow-hidden">
                                <div class="blob-bg opacity-10" style="background: var(--merch-info);"></div>
                                <h5 class="fw-bold">Request Terminal</h5>
                                <button class="btn btn-primary rounded-pill w-50 mx-auto fw-bold shadow-sm mt-3" data-bs-toggle="modal" data-bs-target="#requestPosModal">Order Now</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm h-100 p-4 text-center hover-up position-relative overflow-hidden">
                                <div class="blob-bg opacity-10" style="background: #dc3545;"></div>
                                <h5 class="fw-bold">Report Faulty POS</h5>
                                <button class="btn btn-outline-danger rounded-pill w-50 mx-auto fw-bold mt-3" data-bs-toggle="modal" data-bs-target="#complaintModal">Log Complaint</button>
                            </div>
                        </div>
                    </div>

                    <div class="card border-0 shadow-sm mt-4">
                        <div class="card-header bg-white border-0 py-3 d-flex justify-content-between"><h6 class="fw-bold mb-0">Live Terminal Status</h6><button class="btn btn-sm btn-light" onclick="refreshFleetStatus(this)">Refresh</button></div>
                        <div class="table-responsive">
                            <table class="table align-middle mb-0 table-hover">
                                <thead class="bg-light"><tr><th class="ps-4">Name</th><th>Serial</th><th>Status</th><th class="text-end pe-4">Action</th></tr></thead>
                                <tbody>
                                    <tr>
                                        <td class="ps-4 fw-bold">Main Counter</td><td>SN-99210</td><td><span class="badge bg-success">Online</span></td>
                                        <td class="text-end pe-4"><button class="btn btn-sm btn-outline-dark rounded-pill" onclick="openTerminalSettings('Main Counter', 'SN-99210')">Manage</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- ================= SECTION 4: STAFF MANAGER ================= -->
               <section id="staff-section" class="content-section d-none fade-in">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h5 class="fw-bold mb-0">Staff & Payroll</h5>
      <small class="text-muted">Automated Salary Payments</small>
    </div>
    <button class="btn btn-primary rounded-pill shadow-sm" data-bs-toggle="modal" data-bs-target="#newStaffModal">
      <i class="bi bi-person-plus-fill me-2"></i> Add Staff
    </button>
  </div>

  <div class="card border-0 shadow-sm">
    <div class="card-header bg-white border-0 py-3">
      <h6 class="fw-bold mb-0">Payroll List (Dec 2025)</h6>
    </div>
    <div class="table-responsive">
      <table class="table align-middle mb-0 table-hover">
        <thead class="bg-light">
          <tr>
            <th class="ps-4">Name</th>
            <th>Role</th>
            <th>Salary</th>
            <th>Status</th>
            <th class="text-end pe-4">Action</th>
          </tr>
        </thead>
        <tbody id="staffTableBody">
          
          <!-- Staff 1: Manager -->
          <tr>
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center me-2 fw-bold" style="width: 35px; height: 35px;">CO</div>
                <div>
                  <span class="fw-bold text-dark">Chidinma Okeke</span><br>
                  <small class="text-muted" style="font-size: 0.75rem;">GTBank ••• 4421</small>
                </div>
              </div>
            </td>
            <td>Store Manager</td>
            <td class="font-monospace fw-bold">₦180,000</td>
            <td><span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Active</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil-fill text-muted"></i></button>
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#stopPayModal"><i class="bi bi-pause-fill"></i></button>
            </td>
          </tr>

          <!-- Staff 2: Senior Cashier -->
          <tr>
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="bg-warning bg-opacity-10 text-warning rounded-circle d-flex align-items-center justify-content-center me-2 fw-bold" style="width: 35px; height: 35px;">YI</div>
                <div>
                  <span class="fw-bold text-dark">Yusuf Ibrahim</span><br>
                  <small class="text-muted" style="font-size: 0.75rem;">Access ••• 9920</small>
                </div>
              </div>
            </td>
            <td>Senior Cashier</td>
            <td class="font-monospace fw-bold">₦85,000</td>
            <td><span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Active</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil-fill text-muted"></i></button>
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#stopPayModal"><i class="bi bi-pause-fill"></i></button>
            </td>
          </tr>

          <!-- Staff 3: Stock Keeper -->
          <tr>
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="bg-info bg-opacity-10 text-info rounded-circle d-flex align-items-center justify-content-center me-2 fw-bold" style="width: 35px; height: 35px;">TA</div>
                <div>
                  <span class="fw-bold text-dark">Tolu Adebayo</span><br>
                  <small class="text-muted" style="font-size: 0.75rem;">Opay ••• 1102</small>
                </div>
              </div>
            </td>
            <td>Stock Keeper</td>
            <td class="font-monospace fw-bold">₦65,000</td>
            <td><span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Active</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil-fill text-muted"></i></button>
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#stopPayModal"><i class="bi bi-pause-fill"></i></button>
            </td>
          </tr>

          <!-- Staff 4: Security -->
          <tr>
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="bg-danger bg-opacity-10 text-danger rounded-circle d-flex align-items-center justify-content-center me-2 fw-bold" style="width: 35px; height: 35px;">EN</div>
                <div>
                  <span class="fw-bold text-dark">Emeka Nwosu</span><br>
                  <small class="text-muted" style="font-size: 0.75rem;">Zenith ••• 3319</small>
                </div>
              </div>
            </td>
            <td>Security Officer</td>
            <td class="font-monospace fw-bold">₦60,000</td>
            <td><span class="badge bg-warning bg-opacity-10 text-warning rounded-pill px-3">Pending</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil-fill text-muted"></i></button>
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#stopPayModal"><i class="bi bi-pause-fill"></i></button>
            </td>
          </tr>

          <!-- Staff 5: Cleaner -->
          <tr>
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="bg-secondary bg-opacity-10 text-secondary rounded-circle d-flex align-items-center justify-content-center me-2 fw-bold" style="width: 35px; height: 35px;">AB</div>
                <div>
                  <span class="fw-bold text-dark">Aisha Bello</span><br>
                  <small class="text-muted" style="font-size: 0.75rem;">Kuda ••• 5501</small>
                </div>
              </div>
            </td>
            <td>Cleaner / Utility</td>
            <td class="font-monospace fw-bold">₦50,000</td>
            <td><span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">Active</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil-fill text-muted"></i></button>
              <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#stopPayModal"><i class="bi bi-pause-fill"></i></button>
            </td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>
</section>

<div class="modal fade" id="receiptModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content border-0 shadow-lg position-relative overflow-hidden">
      <!-- Watermark -->
      <div class="position-absolute top-50 start-50 translate-middle" style="opacity: 0.05; pointer-events: none;">
        <i class="bi bi-fingerprint" style="font-size: 10rem; color: #000;"></i>
      </div>

      <div class="modal-body p-0">
        <!-- Receipt Header -->
        <div class="bg-success p-4 text-center text-white relative">
          <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"></button>
          <div class="mb-2"><i class="bi bi-check-circle-fill" style="font-size: 3rem;"></i></div>
          <h6 class="text-uppercase letter-spacing-2 opacity-75 mb-0">Transaction Successful</h6>
          <h2 class="fw-bold mt-2 mb-0" id="receiptAmount">₦0.00</h2>
          <small id="receiptDate" class="text-white-50">Loading...</small>
        </div>

        <!-- Receipt Body -->
        <div class="p-4">
          <div class="d-flex justify-content-between mb-3 border-bottom pb-2">
            <span class="text-muted small">Type</span>
            <span class="fw-bold text-dark text-end" id="receiptType">Transfer</span>
          </div>
          <div class="d-flex justify-content-between mb-3 border-bottom pb-2">
            <span class="text-muted small">Reference</span>
            <span class="font-monospace fw-bold text-dark text-end" id="receiptRef">REF-000</span>
          </div>
          <div class="d-flex justify-content-between mb-3 border-bottom pb-2">
            <span class="text-muted small">Party</span>
            <span class="fw-bold text-dark text-end" id="receiptParty">Name</span>
          </div>
          <div class="d-flex justify-content-between mb-3 border-bottom pb-2">
            <span class="text-muted small">Desc</span>
            <span class="fw-bold text-dark text-end" id="receiptDesc">Desc</span>
          </div>
        </div>

        <!-- Footer -->
        <div class="p-3 bg-light d-flex gap-2">
          <button class="btn btn-outline-dark flex-fill" onclick="shareReceipt()"><i class="bi bi-share-fill me-2"></i> Share</button>
          <button class="btn btn-dark flex-fill" onclick="downloadReceipt()"><i class="bi bi-download me-2"></i> Save PDF</button>
        </div>
      </div>
    </div>
  </div>
</div>
                
                <!-- ================= SECTION 6: DETAILED SETTINGS ================= -->
                <section id="settings-section" class="content-section d-none fade-in">
                    <div class="d-flex align-items-center mb-4">
                        <button class="btn btn-white rounded-circle me-3 shadow-sm text-primary" onclick="showSection('dashboard', document.querySelector('.nav-link.active'), event)">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div><h4 class="fw-bold mb-0">Business Settings</h4><small class="text-muted">Manage store profile & security.</small></div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-3">
                            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                                <div class="list-group list-group-flush" id="settingsTabs">
                                    <button class="list-group-item list-group-item-action p-3 active border-0 d-flex align-items-center gap-3 settings-tab-link" onclick="openSettingTab('business', this)"><i class="bi bi-shop fs-5"></i> Business Profile</button>
                                    <button class="list-group-item list-group-item-action p-3 border-0 d-flex align-items-center gap-3 settings-tab-link" onclick="openSettingTab('kyc', this)"><i class="bi bi-file-earmark-check fs-5"></i> KYC & Docs</button>
                                    <button class="list-group-item list-group-item-action p-3 border-0 d-flex align-items-center gap-3 settings-tab-link" onclick="openSettingTab('settlement', this)"><i class="bi bi-bank fs-5"></i> Settlement</button>
                                    <button class="list-group-item list-group-item-action p-3 border-0 d-flex align-items-center gap-3 settings-tab-link" onclick="openSettingTab('security', this)"><i class="bi bi-shield-lock fs-5"></i> Security</button>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-9">
                            <!-- Business Profile -->
                            <div id="tab-business" class="setting-pane fade-in">
                                <div class="card border-0 shadow-sm rounded-4 p-4">
                                    <h5 class="fw-bold mb-4">Store Details</h5>
                                    <form onsubmit="handleSettingsSave(event)">
                                        <div class="mb-3"><label class="small fw-bold">Business Name</label><input type="text" class="form-control" value="Mama Nkechi General Store"></div>
                                        <div class="mb-3"><label class="small fw-bold">Address</label><textarea class="form-control">Line 2, Yaba Market</textarea></div>
                                        <button class="btn btn-primary px-4 fw-bold">Save Changes</button>
                                    </form>
                                </div>
                            </div>
                            <!-- KYC -->
                            <div id="tab-kyc" class="setting-pane d-none fade-in">
                                <div class="card border-0 shadow-sm rounded-4 p-4">
                                    <div class="d-flex justify-content-between mb-3"><h5 class="fw-bold">Compliance</h5><span class="badge bg-info text-dark">Tier 2</span></div>
                                    <div class="list-group list-group-flush border rounded-3">
                                        <div class="list-group-item d-flex justify-content-between p-3"><div><h6 class="mb-0 fw-bold">Utility Bill</h6><small>Proof of Address</small></div><button class="btn btn-sm btn-outline-dark" onclick="triggerDocUpload()">Upload</button><input type="file" id="docUpload" class="d-none" onchange="handleDocSelected(this)"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Settlement -->
                            <div id="tab-settlement" class="setting-pane d-none fade-in">
                                <div class="card border-0 shadow-sm rounded-4 p-4">
                                    <h5 class="fw-bold mb-4">Settlement Account</h5>
                                    <div class="bg-dark-blue text-white p-4 rounded-4 mb-4"><h3 class="font-monospace mb-0">012****899</h3><small>Zenith Bank</small></div>
                                    <button class="btn btn-outline-primary w-100 fw-bold" data-bs-toggle="modal" data-bs-target="#changeBankModal">Change Account</button>
                                </div>
                            </div>
                            <!-- Security -->
                            <div id="tab-security" class="setting-pane d-none fade-in">
                                <div class="card border-0 shadow-sm rounded-4 p-4">
                                    <h5 class="fw-bold mb-4">Security</h5>
                                    <div class="d-flex justify-content-between border-bottom pb-3 mb-3"><div><h6 class="fw-bold mb-0">Transaction PIN</h6></div><button class="btn btn-outline-dark btn-sm" data-bs-toggle="modal" data-bs-target="#changePinModal">Change</button></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
         
 <!-- ================= SECTION 7: CREDIT AI 4.0 (Unified) ================= -->
<section id="credit-section" class="content-section d-none fade-in">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h5 class="fw-bold mb-0">Merchant AI Hub</h5>
            <small class="text-muted">Generative Finance, Health & Education.</small>
        </div>
        <span class="badge bg-info bg-opacity-10 text-dark-blue border border-info shadow-sm">
            <i class="bi bi-stars"></i> Credit AI 4.0
        </span>
    </div>

    <!-- The AI Container Card -->
    <div class="card border-0 shadow-lg rounded-4 overflow-hidden bg-dark-blue text-white position-relative" style="min-height: 700px; background-color: #0b1c33;">
        <!-- Background Animation -->
        <div class="position-absolute top-0 start-0 w-100 h-100" style="background: radial-gradient(circle at 50% 50%, rgba(13, 202, 240, 0.15) 0%, transparent 70%); pointer-events: none;"></div>
        
        <div class="card-body p-4 p-lg-5 d-flex flex-column align-items-center justify-content-center text-center position-relative z-1">
            
            <!-- STATE 1: INITIAL -->
            <div id="aiInitialState">
                <div class="icon-sq bg-white bg-opacity-10 text-info rounded-circle mx-auto mb-4" style="width: 80px; height: 80px; display:flex; align-items:center; justify-content:center;">
                    <i class="bi bi-cpu-fill fs-1"></i>
                </div>
                <h2 class="fw-bold mb-3">Unlock Capital & Growth</h2>
                <p class="text-white-50 col-md-8 mx-auto mb-4">
                    AI 4.0 analyzes your transactions, plans your health expenses, and teaches you business skills in your local language.
                </p>
                <button class="btn btn-info text-dark fw-bold btn-lg rounded-pill px-5 shadow-lg hover-scale" onclick="simulateGenerateCreditProfile()">
                    <i class="bi bi-magic me-2"></i> Analyze My Business
                </button>
            </div>

            <!-- STATE 2: LOADING -->
            <div id="aiLoadingState" class="d-none">
                <div class="spinner-border text-info mb-3" style="width: 3rem; height: 3rem;" role="status"></div>
                <h4 class="fw-bold animate-pulse" id="aiLoadingText">Analyzing Transaction Patterns...</h4>
                <p class="text-white-50 small">Integrating SDG Modules...</p>
            </div>

            <!-- STATE 3: RESULT DASHBOARD -->
            <div id="aiResultState" class="d-none w-100 text-start">
                
                <!-- FEATURE: PROJECT ALERT -->
                <div class="alert alert-info border-0 bg-info bg-opacity-10 d-flex align-items-center mb-4">
                    <i class="bi bi-lightbulb-fill fs-4 me-3 text-info"></i>
                    <div class="flex-grow-1">
                        <h6 class="fw-bold text-white mb-1">Smart Insight: Shop Renovation</h6>
                        <p class="mb-0 text-white-50 small">Active project detected. Fund remaining <strong>N300,000</strong> instantly.</p>
                    </div>
                    <button class="btn btn-sm btn-info text-dark fw-bold rounded-pill" onclick="selectLoan('300,000')">Fund Project</button>
                </div>

                <!-- SCORE ROW -->
                <div class="row g-4 mb-4 border-bottom border-white border-opacity-10 pb-4">
                    <div class="col-lg-4 text-center text-lg-start border-end border-white border-opacity-10">
                        <small class="text-uppercase text-info letter-spacing-2 fw-bold">FingerPay Trust Score</small>
                        <h1 class="display-1 fw-bold text-white mb-0" id="creditScore">785</h1>
                        <span class="badge bg-success mt-2 px-3 py-2 rounded-pill">Excellent</span>
                    </div>
                    <div class="col-lg-8">
                        <h5 class="fw-bold text-white mb-2"><i class="bi bi-graph-up-arrow me-2 text-warning"></i>Market Analysis</h5>
                        <div class="p-3 bg-white bg-opacity-10 rounded-3 border border-white border-opacity-10">
                            <p class="mb-0 text-white-50 fst-italic">
                                "<strong>Great Job!</strong> You rank in the <strong>top 10%</strong> of retail merchants. Your return rate is <strong>20% higher</strong> than average. You qualify for Health & Education grants."
                            </p>
                        </div>
                    </div>
                </div>

                <!-- NEW FEATURE: SDG ADD-ONS (The "Pop-up" Triggers) -->
                <h6 class="fw-bold text-white mb-3 text-uppercase small ls-1 text-opacity-50">Merchant Wellness & Education</h6>
                <div class="row g-3 mb-5">
                    <!-- SDG 3: Health -->
                    <div class="col-md-4">
                        <div class="card bg-danger bg-opacity-10 border border-danger border-opacity-25 h-100 hover-scale" onclick="new bootstrap.Modal(document.getElementById('healthModal')).show()">
                            <div class="card-body d-flex align-items-center cursor-pointer">
                                <div class="bg-danger bg-opacity-25 p-3 rounded-circle me-3">
                                    <i class="bi bi-heart-pulse-fill text-danger fs-4"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold text-white mb-0">Health Planner</h6>
                                    <small class="text-white-50" style="font-size: 0.75rem;">Expense & Illness Plan</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- SDG 4: Business School -->
                    <div class="col-md-4">
                        <div class="card bg-warning bg-opacity-10 border border-warning border-opacity-25 h-100 hover-scale" onclick="new bootstrap.Modal(document.getElementById('schoolModal')).show()">
                            <div class="card-body d-flex align-items-center cursor-pointer">
                                <div class="bg-warning bg-opacity-25 p-3 rounded-circle me-3">
                                    <i class="bi bi-mortarboard-fill text-warning fs-4"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold text-white mb-0">Biz School</h6>
                                    <small class="text-white-50" style="font-size: 0.75rem;">Lessons in 5 Languages</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- SDG 4: Loan Literacy -->
                    <div class="col-md-4">
                        <div class="card bg-primary bg-opacity-10 border border-primary border-opacity-25 h-100 hover-scale" onclick="new bootstrap.Modal(document.getElementById('literacyModal')).show()">
                            <div class="card-body d-flex align-items-center cursor-pointer">
                                <div class="bg-primary bg-opacity-25 p-3 rounded-circle me-3">
                                    <i class="bi bi-translate text-primary fs-4"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold text-white mb-0">Loan Explainer</h6>
                                    <small class="text-white-50" style="font-size: 0.75rem;">Terms in Local Dialects</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LOAN TIERS (Original Feature) -->
                <h5 class="fw-bold text-white mb-3">Available Financing Options</h5>
                <div class="row g-3 mb-5">
                    <!-- Offer 1 -->
                    <div class="col-md-4">
                        <div class="card bg-transparent border border-white border-opacity-25 h-100 hover-up">
                            <div class="card-body p-3 text-center">
                                <div class="badge bg-info text-dark mb-2">Quick Cash</div>
                                <h3 class="fw-bold text-white">N50,000</h3>
                                <p class="text-white-50 small">Instant Disbursement</p>
                                <button class="btn btn-outline-light w-100 rounded-pill btn-sm mt-2" onclick="selectLoan('50,000')">Select</button>
                            </div>
                        </div>
                    </div>
                    <!-- Offer 2 -->
                    <div class="col-md-4">
                        <div class="card bg-success bg-opacity-10 border border-success h-100 hover-up shadow">
                            <div class="card-body p-3 text-center position-relative">
                                <span class="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-success">Recommended</span>
                                <div class="badge bg-warning text-dark mb-2 mt-2">Growth Fund</div>
                                <h3 class="fw-bold text-white">N200,000</h3>
                                <p class="text-white-50 small">Business Expansion</p>
                                <button class="btn btn-success w-100 rounded-pill btn-sm fw-bold mt-2" onclick="selectLoan('200,000')">Select</button>
                            </div>
                        </div>
                    </div>
                    <!-- Offer 3 -->
                    <div class="col-md-4">
                        <div class="card bg-transparent border border-white border-opacity-25 h-100 hover-up">
                            <div class="card-body p-3 text-center">
                                <div class="badge bg-light text-dark mb-2">Inventory</div>
                                <h3 class="fw-bold text-white">N500,000</h3>
                                <p class="text-white-50 small">Supplier Direct Pay</p>
                                <button class="btn btn-outline-light w-100 rounded-pill btn-sm mt-2" onclick="selectLoan('500,000')">Select</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UPGRADED SIMULATOR: BUSINESS GROWTH AI -->
                <div class="bg-black bg-opacity-50 rounded-4 p-4 border border-white border-opacity-10">
                    <div class="d-flex align-items-center mb-3">
                        <div class="spinner-grow spinner-grow-sm text-info me-2" role="status"></div>
                        <h5 class="fw-bold text-info mb-0">Merchant Growth Simulator</h5>
                    </div>
                    <p class="text-white-50 small mb-3">Project future outcomes based on your plans.</p>
                    
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="text-white-50 small mb-1">Project Plan</label>
                            <select class="form-select form-select-sm bg-dark text-white border-secondary" id="simProject">
                                <option value="new_stock">Buy New Stock</option>
                                <option value="renovation">Shop Renovation</option>
                                <option value="marketing">Local Marketing</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="text-white-50 small mb-1">Transaction Goal</label>
                            <select class="form-select form-select-sm bg-dark text-white border-secondary" id="simGoal">
                                <option value="10">Increase by 10%</option>
                                <option value="25">Increase by 25%</option>
                                <option value="50">Increase by 50%</option>
                            </select>
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-info w-100 btn-sm fw-bold rounded-pill" onclick="runAdvancedSimulation()">
                                <i class="bi bi-cpu me-1"></i> Simulate Outcome
                            </button>
                        </div>
                    </div>

                    <!-- Simulation Result -->
                    <div id="simulationResult" class="mt-3 p-3 rounded bg-info bg-opacity-10 border-start border-4 border-info d-none fade-in">
                        <div class="d-flex">
                            <i class="bi bi-stars text-info fs-4 me-3"></i>
                            <div>
                                <h6 class="fw-bold text-white mb-1">AI Projection:</h6>
                                <p class="mb-0 text-white-50 small" id="simText">Loading prediction...</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>

            </div>
        </div>
    </div>

    <!-- ================= MODALS ================= -->
<!-- ================== PROJECT MANAGEMENT MODALS ================== -->

<!-- 1. New Project Modal (Added: Category, Date, Auto-Fee Calculation) -->
<div class="modal fade" id="newProjectModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header bg-dark-blue text-white">
                <h5 class="fw-bold">Create Project</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handleNewProject(event)">
                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Project Details</label>
                        <input type="text" class="form-control mb-2" id="projName" placeholder="Project Title" required>
                        <select class="form-select" id="projCategory">
                            <option value="Construction">Construction & Renovation</option>
                            <option value="Tech">Tech Infrastructure</option>
                            <option value="Marketing">Marketing Campaign</option>
                            <option value="Logistics">Logistics Expansion</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Financials</label>
                        <div class="input-group mb-2">
                            <span class="input-group-text">₦</span>
                            <input type="number" class="form-control" id="projTarget" placeholder="Target Amount" oninput="calcProjectFees()" required>
                        </div>
                        <!-- Dynamic Calculation Display -->
                        <div class="d-flex justify-content-between small bg-light p-2 rounded">
                            <span class="text-muted">Est. Platform Fee (5%):</span>
                            <span class="fw-bold text-danger" id="projFeeDisplay">₦0.00</span>
                        </div>
                        <div class="d-flex justify-content-between small px-2 mt-1">
                            <span class="text-muted">Net Budget:</span>
                            <span class="fw-bold text-success" id="projNetDisplay">₦0.00</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary w-100 rounded-pill">Launch Project</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 2. Add Funds Modal (Added: Source, Fee Calculation) -->
<div class="modal fade" id="addFundsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content border-0">
            <div class="modal-header bg-success text-white">
                <h5 class="fw-bold">Fund Project</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handleAddFunds(event)">
                    <label class="small fw-bold text-muted mb-1">Source</label>
                    <select class="form-select mb-3 form-select-sm">
                        <option>Main Wallet (₦1.2M)</option>
                        <option>Linked Bank (Access)</option>
                        <option>Crypto Deposit</option>
                    </select>

                    <label class="small fw-bold text-muted mb-1">Amount</label>
                    <input type="number" class="form-control mb-2" id="fundAmount" placeholder="0.00" oninput="calcFundTotal()">
                    
                    <p class="small text-end text-muted mb-3">
                        Total Charge: <span class="fw-bold text-dark" id="fundTotalDisplay">₦0.00</span>
                    </p>
                    <button class="btn btn-success w-100">Deposit Funds</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 3. Add Task Modal (Added: Hourly Calc, Staff Assignment) -->
<div class="modal fade" id="addTaskModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header border-0">
                <h5 class="fw-bold">Add Task</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handleAddTask(event)">
                    <input type="text" class="form-control mb-3" id="taskNameInput" placeholder="Task Name (e.g. Site Survey)" required>
                    
                    <div class="row g-2 mb-3">
                        <div class="col-6">
                            <label class="small text-muted">Est. Hours</label>
                            <input type="number" class="form-control" id="taskHours" placeholder="Hrs" oninput="calcTaskCost()">
                        </div>
                        <div class="col-6">
                            <label class="small text-muted">Rate/Hr</label>
                            <input type="number" class="form-control" id="taskRate" value="5000" oninput="calcTaskCost()">
                        </div>
                    </div>

                    <div class="input-group mb-3">
                        <span class="input-group-text bg-light fw-bold">Total Cost: ₦</span>
                        <input type="text" class="form-control bg-white fw-bold" id="taskTotalCost" value="0" readonly>
                    </div>

                    <div class="row g-2 mb-3">
                        <div class="col-12">
                            <select class="form-select" id="taskPriority">
                                <option value="Normal">Priority: Normal</option>
                                <option value="High" class="text-danger fw-bold">Priority: High</option>
                                <option value="Low">Priority: Low</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-dark-blue w-100" style="background-color: #0d6efd; color: white;">Add Task</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- ================== HR & STAFF MODALS ================== -->

<!-- 4. New Staff Modal (Added: Expanded Banks, Tax/Net Pay Calculator) -->
<div class="modal fade" id="newStaffModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header bg-primary text-white">
                <h5 class="fw-bold">Add Staff</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form id="addStaffForm" onsubmit="handleNewStaff(event)">
                    <input type="text" class="form-control mb-3" id="staffName" placeholder="Full Name" required>
                    <input type="text" class="form-control mb-3" id="staffRole" placeholder="Job Title / Role" required>
                    
                    <!-- Calculator Section -->
                    <div class="bg-light p-3 rounded mb-3 border">
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <label class="small fw-bold">Gross Salary</label>
                                <input type="number" class="form-control" id="staffSalary" placeholder="Amount" oninput="calcStaffPay()">
                            </div>
                            <div class="col-6">
                                <label class="small fw-bold">Bank</label>
                                <select class="form-select" id="staffBank">
                                    <option>Zenith Bank</option>
                                    <option>GTBank</option>
                                    <option>Access Bank</option>
                                    <option>UBA</option>
                                    <option>First Bank</option>
                                    <option>Kuda MFB</option>
                                    <option>OPay</option>
                                </select>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between small text-muted">
                            <span>Tax (7.5%): <span id="staffTax">₦0.00</span></span>
                            <span>Net Pay: <strong class="text-success" id="staffNet">₦0.00</strong></span>
                        </div>
                    </div>

                    <div class="col-12 mb-3">
                        <input type="text" class="form-control" id="staffAcct" placeholder="10-Digit Account Number" maxlength="10">
                    </div>
                    
                    <div class="col-12 mb-3">
                        <div class="btn-group w-100">
                            <input type="radio" class="btn-check" name="paySource" id="srcWallet" checked>
                            <label class="btn btn-outline-secondary" for="srcWallet">Wallet</label>
                            
                            <input type="radio" class="btn-check" name="paySource" id="srcCard">
                            <label class="btn btn-outline-secondary" for="srcCard">Card</label>
                        </div>
                    </div>
                    <button class="btn btn-primary w-100">Onboard Staff</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 5. Stop Pay Modal (Added: Reason Selector) -->
<div class="modal fade" id="stopPayModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content border-0 text-center p-4">
            <h5 class="fw-bold text-danger">Pause Salary?</h5>
            <p class="small text-muted">Select a reason to proceed.</p>
            
            <select class="form-select form-select-sm mb-3" id="stopPayReason">
                <option value="">Select Reason...</option>
                <option value="disciplinary">Disciplinary Action</option>
                <option value="leave">Unpaid Leave</option>
                <option value="resignation">Resignation Processing</option>
                <option value="other">Other Investigation</option>
            </select>

            <div class="d-flex justify-content-center gap-2 mt-3">
                <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-warning" onclick="handleStopPayAction()">Confirm Pause</button>
            </div>
        </div>
    </div>
</div>

<!-- ================== LOGISTICS & TERMINAL MODALS ================== -->

<!-- 6. Request POS Modal (Added: Type Selection & Price Calculation) -->
<div class="modal fade" id="requestPosModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header bg-dark-blue text-white" style="background-color: #1f2937;">
                <h5 class="fw-bold">Order Terminal</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handlePosOrder(event)">
                    <div class="mb-3">
                        <label class="small fw-bold">Terminal Type</label>
                        <select class="form-select" id="posType" onchange="calcPosTotal()">
                            <option value="25000">Android Smart POS (₦25,000)</option>
                            <option value="15000">Analog Button POS (₦15,000)</option>
                            <option value="45000">Mini-Android (₦45,000)</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="small fw-bold">Quantity</label>
                        <input type="number" class="form-control" id="posQty" value="1" min="1" oninput="calcPosTotal()">
                    </div>

                    <div class="mb-3">
                         <label class="small fw-bold">Delivery Address</label>
                         <textarea class="form-control" rows="2" placeholder="Enter branch address..."></textarea>
                    </div>

                    <button class="btn btn-primary w-100 d-flex justify-content-between align-items-center">
                        <span>Checkout</span>
                        <span class="fw-bold" id="posTotalBtn">₦25,000</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 7. Complaint Modal (Added: Ticket ID generation, Category) -->
<div class="modal fade" id="complaintModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header bg-danger text-white">
                <h5 class="fw-bold">Report Issue</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form onsubmit="handleComplaint(event)">
                    <div class="row g-2 mb-3">
                        <div class="col-8">
                            <select class="form-select">
                                <option>Network Failure</option>
                                <option>Printer Jam</option>
                                <option>Software Crash</option>
                                <option>Battery Issue</option>
                            </select>
                        </div>
                        <div class="col-4">
                            <select class="form-select text-danger fw-bold">
                                <option>High</option>
                                <option>Med</option>
                                <option>Low</option>
                            </select>
                        </div>
                    </div>
                    <textarea class="form-control mb-3" placeholder="Describe issue details..." rows="3" required></textarea>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="uploadLogs" checked>
                        <label class="form-check-label small" for="uploadLogs">Attach Terminal Logs</label>
                    </div>
                    <button class="btn btn-danger w-100">Submit Ticket</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 8. Consumables Modal (Added: Stock check & Price) -->
<div class="modal fade" id="consumablesModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content border-0">
            <div class="modal-header border-0">
                <h5 class="fw-bold">Supplies</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form onsubmit="handleSupplies(event)">
                    <select class="form-select mb-2" id="supplyItem">
                        <option value="500">Thermal Rolls (Pack of 10)</option>
                        <option value="1200">Terminal Battery</option>
                        <option value="2000">Charging Dock</option>
                    </select>
                    
                    <div class="d-flex align-items-center gap-2 mb-3">
                        <input type="number" class="form-control" value="1" placeholder="Qty">
                        <span class="badge bg-success bg-opacity-10 text-success border border-success">In Stock</span>
                    </div>

                    <button class="btn btn-dark w-100">Request Supply</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 9. Terminal Settings (Added: Diagnostic Tools) -->
<div class="modal fade" id="terminalSettingsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
            <div class="modal-header border-0">
                <h5 class="fw-bold">Manage Terminal</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-secondary p-2 mb-3 small d-flex justify-content-between">
                    <span>Merchant ID:</span> <strong class="font-monospace">MER-88291</strong>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <button class="btn btn-light w-100 border h-100 py-3" onclick="simulateTerminalAction('Rebooting System...', 3000)">
                            <i class="bi bi-power text-danger d-block fs-4 mb-1"></i> Reboot
                        </button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-light w-100 border h-100 py-3" onclick="simulateTerminalAction('Testing Network...', 2000)">
                            <i class="bi bi-wifi text-primary d-block fs-4 mb-1"></i> Net Test
                        </button>
                    </div>
                </div>

                <label class="small fw-bold">Device Alias</label>
                <div class="input-group mt-1">
                    <input type="text" class="form-control" id="terminalRenameInput" value="Counter-1 POS">
                    <button class="btn btn-dark" onclick="simulateTerminalAction('Alias Updated!', 500)">Save</button>
                </div>
                
                <hr>
                <button class="btn btn-outline-danger w-100 btn-sm" onclick="confirm('Factory Reset? This cannot be undone.')">Factory Reset</button>
            </div>
        </div>
    </div>
</div>

 <!-- 1. BIOMETRIC LOAN MODAL (Original) -->
<div class="modal fade" id="loanModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-success text-white">
                <h5 class="fw-bold"><i class="bi bi-cash-coin me-2"></i>Accept Micro-Loan</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            
            <div class="modal-body p-4 text-center" id="loanStep1">
                <div class="mb-3"><i class="bi bi-bank2 text-success display-4"></i></div>
                <h4 class="fw-bold text-dark-blue">Confirm Details</h4>
                <div class="bg-light p-3 rounded mb-3 border border-dashed">
                    <div class="d-flex justify-content-between mb-2">
                        <span>Principal Amount:</span>
                        <strong class="text-dark fs-5" id="loanPrincipal">N0.00</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Processing Fee:</span>
                        <span class="text-danger">- N500.00</span>
                    </div>
                    <div class="d-flex justify-content-between border-top pt-2 mt-2">
                        <span>Total Repayment:</span>
                        <strong class="text-success" id="loanRepayment">calculating...</strong>
                    </div>
                </div>
                <button class="btn btn-success w-100 btn-lg fw-bold shadow-sm" onclick="initiateLoanBiometrics()">
                    <i class="bi bi-fingerprint me-2"></i> Sign with Fingerprint
                </button>
            </div>

            <div class="modal-body p-5 text-center d-none" id="loanStep2">
                <h5 class="fw-bold text-dark-blue mb-4">Biometric Signature</h5>
                <div class="position-relative mx-auto mb-4" style="width: 100px; height: 120px;">
                    <div class="border border-2 border-info rounded-3 w-100 h-100 d-flex align-items-center justify-content-center overflow-hidden position-relative" style="background: #0b1c33;">
                        <i class="bi bi-fingerprint text-white opacity-25 fs-1" id="loanScanIcon"></i>
                        <div class="position-absolute w-100 bg-info shadow" style="height: 2px; top: 0; animation: scanDown 1.5s infinite linear; box-shadow: 0 0 10px #0dcaf0;"></div>
                    </div>
                </div>
                <p class="text-muted small fw-bold animate-pulse" id="loanScanText">Place Merchant Finger on Sensor...</p>
            </div>
        </div>
    </div>
</div>

<!-- 2. HEALTH EXPENSE PLANNER (SDG 3) -->
<div class="modal fade" id="healthModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg bg-dark text-white">
            <div class="modal-header border-bottom border-secondary">
                <h5 class="fw-bold text-danger"><i class="bi bi-heart-pulse me-2"></i>Health Expense AI</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <p class="text-white-50 small">Plan for unforeseen health issues to protect your business capital.</p>
                <form id="healthForm">
                    <div class="mb-3">
                        <label class="form-label small">Possible Health Concern</label>
                        <select class="form-select bg-dark text-white border-secondary" id="healthIssue">
                            <option value="Malaria">Malaria Treatment (N10,000)</option>
                            <option value="Typhoid">Typhoid Medication (N15,000)</option>
                            <option value="Checkup">General Checkup (N5,000)</option>
                            <option value="Family">Family Emergency Fund (N50,000)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label small">Target Savings Period</label>
                        <select class="form-select bg-dark text-white border-secondary" id="healthFreq">
                            <option value="30">1 Month</option>
                            <option value="90">3 Months</option>
                            <option value="180">6 Months</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-danger w-100 rounded-pill" onclick="calculateHealthPlan()">Generate Plan</button>
                </form>
                <div id="healthResult" class="mt-3 p-3 bg-danger bg-opacity-10 rounded border border-danger border-opacity-25 d-none fade-in">
                    <h6 class="fw-bold">Your Daily Savings Plan:</h6>
                    <h3 class="mb-1 fw-bold text-white" id="healthDaily">N0.00</h3>
                    <p class="small text-white-50 mb-0">Save this daily to cover <span class="text-white" id="healthName"></span>.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 3. SMALL BUSINESS SCHOOL (SDG 4) -->
<div class="modal fade" id="schoolModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border-0 shadow-lg bg-dark text-white">
            <div class="modal-header border-bottom border-secondary bg-warning bg-opacity-10">
                <h5 class="fw-bold text-warning"><i class="bi bi-mortarboard me-2"></i>Small Business School</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-0">
                <!-- Language Tabs -->
                <ul class="nav nav-pills nav-fill p-2 bg-black bg-opacity-25" id="langTabs">
                    <li class="nav-item"><button class="nav-link active rounded-pill small" onclick="renderSchool('en', this)">English</button></li>
                    <li class="nav-item"><button class="nav-link rounded-pill small" onclick="renderSchool('pidgin', this)">Pidgin</button></li>
                    <li class="nav-item"><button class="nav-link rounded-pill small" onclick="renderSchool('yoruba', this)">Yoruba</button></li>
                    <li class="nav-item"><button class="nav-link rounded-pill small" onclick="renderSchool('igbo', this)">Igbo</button></li>
                    <li class="nav-item"><button class="nav-link rounded-pill small" onclick="renderSchool('hausa', this)">Hausa</button></li>
                </ul>
                <div class="p-4" id="schoolContent">
                    <!-- Lessons Injected via JS -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 4. LOAN LITERACY EXPLAINER (SDG 4) -->
<div class="modal fade" id="literacyModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg bg-dark text-white">
            <div class="modal-header border-bottom border-secondary bg-primary bg-opacity-10">
                <h5 class="fw-bold text-primary"><i class="bi bi-translate me-2"></i>Loan Literacy</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <div class="mb-4">
                    <label class="small text-muted mb-2">Select Language / Yan Harshe / Asụsụ</label>
                    <select class="form-select bg-dark text-white border-secondary" id="litLangSelect" onchange="renderLiteracy()">
                        <option value="en">English</option>
                        <option value="pidgin">Pidgin English</option>
                        <option value="yoruba">Yoruba</option>
                        <option value="igbo">Igbo</option>
                        <option value="hausa">Hausa</option>
                    </select>
                </div>
                <div class="accordion accordion-flush" id="loanTermsAccordion">
                    <!-- Terms Injected via JS -->
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- ================== RECEIPT MODAL ================== -->
<div class="modal fade" id="receiptModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content border-0 shadow-lg position-relative overflow-hidden" style="border-radius: 20px;">
      
      <!-- Watermark Background -->
      <div class="position-absolute top-50 start-50 translate-middle" style="opacity: 0.05; pointer-events: none; z-index: 0;">
        <i class="bi bi-fingerprint" style="font-size: 12rem; color: #000;"></i>
      </div>

      <div class="modal-body p-0 position-relative" style="z-index: 1;">
        
        <!-- Receipt Header (Color changes via JS) -->
        <div class="bg-success p-4 text-center text-white relative transition-bg">
          <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"></button>
          
          <div class="mb-2 mt-2">
            <i class="bi bi-check-circle-fill" style="font-size: 3.5rem;"></i>
          </div>
          
          <h6 class="text-uppercase letter-spacing-2 opacity-75 mb-0" style="font-size: 0.7rem;">Transaction Status</h6>
          <h5 class="fw-bold mt-1">Successful</h5>
          
          <h2 class="fw-bold mt-3 mb-0" id="receiptAmount">₦0.00</h2>
          <small id="receiptDate" class="text-white-50" style="font-size: 0.8rem;">Loading Date...</small>
        </div>

        <!-- Zig-Zag/Tear Effect Divider -->
        <div style="height: 12px; background: radial-gradient(circle, transparent, transparent 50%, #fff 50%, #fff 100%) -7px -8px / 16px 16px repeat-x; margin-top: -6px; position: relative; z-index: 2;"></div>

        <!-- Receipt Details -->
        <div class="p-4">
          
          <div class="d-flex justify-content-between align-items-center mb-3 border-bottom border-light pb-2">
            <span class="text-muted small text-uppercase fw-bold" style="font-size: 0.7rem;">Type</span>
            <span class="fw-bold text-dark text-end" id="receiptType">Transfer</span>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-3 border-bottom border-light pb-2">
            <span class="text-muted small text-uppercase fw-bold" style="font-size: 0.7rem;">Reference</span>
            <span class="font-monospace fw-bold text-dark text-end small" id="receiptRef">REF-000000</span>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-3 border-bottom border-light pb-2">
            <span class="text-muted small text-uppercase fw-bold" style="font-size: 0.7rem;">Party</span>
            <span class="fw-bold text-dark text-end" id="receiptParty">Beneficiary Name</span>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted small text-uppercase fw-bold" style="font-size: 0.7rem;">Narration</span>
            <span class="fw-bold text-dark text-end text-truncate" style="max-width: 150px;" id="receiptDesc">Description</span>
          </div>

        </div>

        <!-- Footer / Actions -->
        <div class="p-3 bg-light border-top d-flex gap-2">
          <button class="btn btn-outline-dark flex-fill rounded-pill" onclick="shareReceipt()">
            <i class="bi bi-share-fill me-1"></i> Share
          </button>
          <button class="btn btn-dark flex-fill rounded-pill" onclick="downloadReceipt()">
            <i class="bi bi-download me-1"></i> PDF
          </button>
        </div>

      </div>
    </div>
  </div>
</div>
    <!-- Delivery Anim -->
    <div class="modal fade" id="deliveryModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0 text-center p-5 overflow-hidden"><h4 class="fw-bold text-primary mb-4">Processing...</h4><div class="delivery-scene mb-4"><div class="truck"><i class="bi bi-truck text-dark-blue fs-1"></i></div><div class="package"><i class="bi bi-box-seam-fill text-warning fs-3"></i></div><div class="road"></div></div><button class="btn btn-success rounded-pill px-4" data-bs-dismiss="modal">Track</button></div></div></div>

    <!-- Agent Contact -->
    <div class="modal fade" id="agentContactModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 text-center p-4"><img src="https://i.pravatar.cc/150?img=11" class="rounded-circle border border-3 border-info mb-3" width="80"><h5 class="fw-bold">Ahmed Musa</h5><p class="text-muted small">0800-AGENT</p><a href="tel:0800" class="btn btn-success w-100"><i class="bi bi-telephone-fill me-2"></i> Call</a></div></div></div>

    <!-- Settings Modals -->
    <div class="modal fade" id="changePinModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0"><div class="modal-header border-0"><h5 class="fw-bold">Update PIN</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form onsubmit="handleFormSubmit(event, 'changePinModal', 'PIN Updated!')"><input type="password" class="form-control mb-3 text-center" placeholder="New PIN"><button class="btn btn-primary w-100">Update</button></form></div></div></div></div>
    <div class="modal fade" id="changeBankModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content border-0"><div class="modal-header bg-dark-blue text-white"><h5 class="fw-bold">Update Bank</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4"><form onsubmit="handleFormSubmit(event, 'changeBankModal', 'Bank Updated!')"><input type="text" class="form-control mb-3" placeholder="Account Number"><button class="btn btn-primary w-100">Verify & Save</button></form></div></div></div></div>

    <!-- Withdraw & Logout & Generic Success -->
    <div class="modal fade" id="withdrawModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0"><div class="modal-header border-0"><h5 class="fw-bold">Withdraw</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><input type="number" class="form-control mb-3" placeholder="Amount"><button class="btn btn-info w-100 text-white fw-bold" onclick="handleFormSubmit(event, 'withdrawModal', 'Withdrawal Processing')">Confirm</button></div></div></div></div>
    <div class="modal fade" id="logoutModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 text-center p-4"><h5 class="fw-bold">Log Out?</h5><div class="d-flex justify-content-center gap-2 mt-3"><button class="btn btn-light" data-bs-dismiss="modal">Cancel</button><button class="btn btn-danger" onclick="window.location.href='merchant-login.html'">Yes</button></div></div></div></div>
    <div class="modal fade" id="genericSuccessModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered modal-sm"><div class="modal-content border-0 text-center p-4"><i class="bi bi-check-circle-fill text-success display-3 mb-3"></i><h4 class="fw-bold">Success!</h4><p class="text-muted small" id="successMessageText">Action completed.</p><button class="btn btn-primary rounded-pill px-4 mt-2" data-bs-dismiss="modal">Okay</button></div></div></div>

    <!-- Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"><div id="staffToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true"><div class="d-flex"><div class="toast-body" id="toastMsg">Success</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div></div></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- API Configuration and Client -->
    <script src="config.js"></script>
    <script src="api.js"></script>
    
    <!-- Dashboard Script -->
    <script src="merchantDB.js"></script>
</body>

</html>
